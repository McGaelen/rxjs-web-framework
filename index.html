<!doctype html>
<html lang="en">
<body>
  <script type="module">
    // import { html } from './html.js'
    import { div, button } from './element.js'
    import {iif} from "./control.js";
    import {state} from "./state.js";
    import {map} from "rxjs";

    // TODO:
    // conditional rendering
    // derived state
    // components
    //   - needs props to be reactive
    //   - needs to accept children

    const count = state(0)
    const isVisible = state(true)

    function increment() {
      count.set$(val => val + 1)
    }

    function MyComponent() {
      return div({ style: 'font-weight: bold;', })`
        ${
          div({ onclick: increment })`
            counter value: ${count}
            ${button({ onclick: increment })`${count}`}
          `
        }

        ${
          div()`
            toggle visibility
            ${button({ onclick: () => isVisible.set$(val => !val)})`
              show/hide
            `}

            ${
              // in reality we probably want to be able to do something like `iif(count >= 1)`
              // and have that be reactive
              iif(isVisible, () =>
                div()`
                  im showing!
                  ${
                    iif(count.pipe(map(c => c > 10)), () =>
                      div()`count is greater than 10`
                    ).elseIf(count.pipe(map(c => c > 0)), () =>
                      'count is less than 10'
                    ).else(() =>
                      'count is 0 or less'
                    )
                  }
                `
              ).else(() =>
                div()`im hiding!`
              )
            }
          `
        }
      `
    }

    document.body.appendChild(MyComponent())
  </script>
</body>
</html>
